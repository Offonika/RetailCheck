Концепция проекта: «Чек-лист-бот»
Вариант: бот на Python живёт на вашем сервере, данные храним в Google Таблицах, без отдельного API и без базы данных.

1) Зачем
Сотрудник заполняет смену в Телеграме «по шагам» (суммы, галочки, фото), бот сразу проверяет ввод и формирует итог.
 Менеджер мгновенно получает сводку и видит все смены в единой Google Таблице.

2) Кто пользуется
Сотрудники магазина — проходят чек-лист, прикладывают фото (Z-отчёт, терминалы).


Менеджеры — получают итог смены, видят расхождения, выгружают отчёты за день/неделю.


Бухгалтер/контролёр (по мере роста) — смотрят лист «Экспорт».



3) Как это работает (простыми шагами)
На кассе висит QR/ссылка `https://t.me/<bot>?start=shop_<id>__open`.


Первый сотрудник, кто нажал «Начать смену», становится opener: бот создаёт единственный run на магазин/дату (`status = opened`).


Opener проходит дневной чек-лист (начальный остаток, X-отчёт, сверки кассы/безнала/кредитов, фото ведомости/эквайринга/терминала, остаток по 1С); бот валидирует ввод и, при дельте ≥ порога, просит комментарий. Closer подключается кнопкой «Продолжить смену» и заполняет тот же список для своей кассы.


Вечером closer жмёт «Начать закрытие» (или QR `...__close`), подтверждает шаг и загружает Z-фото.


После шага «Итог» бот рассчитывает summary, фиксирует run `status = closed` и отправляет менеджеру карточку (opener, closer, дельта, комментарии).


Напоминания: A — 15/30/каждые 45 минут (после 18:00 каждые 10 минут), B — 15/25/каждые 30 минут (после 20:00 каждые 10 минут), закрытие — 10/20/каждые 30 минут после «Начать закрытие». Поток B не стартует, пока ближе не нажал «Продолжить смену».



4) Что входит в первую версию (MVP)
Дневной шаблон (phase=open/continue) общий для A/B с разными стартовыми шагами + мини-шаблон закрытия (phase=close) с шагами «Начать закрытие» и «Фото Z».


Типы шагов: число, текст, чек, фото; phase хранится в Runs/RunSteps.


Автопроверки: формат числа, диапазоны, комментарий при |Δ| ≥ порога, запрет закрытия без фото.


Итог смены в чат менеджеру + запись opener/closer/дельты в Google Таблицу и лист Export.


Напоминания рассчитываются от старта роли: A — 15/30/45→10 после 18:00, B — 15/25/30→10 после 20:00, закрытие — 10/20/30 после «Начать закрытие» (таймзона магазина).


История и статусы: `opened → in_progress → ready_to_close → closed` (+ `returned` при возврате).


Что пока не делаем: автоматическая подгрузка из 1С и веб-панель с графиками (добавим после пилота при необходимости).

5) Где «живет» бот и как это устроено
Ваш сервер (Ubuntu) — один небольшой сервис (Python-бот).


Запуск в Docker (или через systemd).


Nginx/Apache принимает HTTPS и проксирует Telegram-webhook на бота.


Рабочий URL вебхука: https://bot.offonika.ru/checklist/webhook.


Никакой отдельной базы/отдельного API-сервера не нужно.



6) Где лежат данные (Google Таблицы)
Единый файл с листами (вам дадим готовый шаблон):
Users — пользователи и роли.


Shops — магазины.


Templates / TemplateSteps — описание чек-листов и шагов.


Runs — смены (кто/где/когда/статус).


RunSteps — ответы по шагам (суммы, текст, галочки, комментарии, разница «факт − норма»).


Attachments — ссылки на фото (храним только идентификатор фото из Телеграма, сами файлы не дублируем).


Audit — кто и что менял.


Export — готовые выгрузки за день/неделю.


Важно: пишем «пакетно», без дублей; при перегрузке Google бот повторит попытку.

7) Безопасность и доступ
Доступ к Таблице выдается сервисному аккаунту (уровень «Редактор»).


В боте — белый список пользователей и магазинов.


Фото не храним у себя — используем «техссылку» Телеграма.



8) Сроки запуска
Подготовка шаблонов и прототип, подключение к Таблице: 2–3 дня.


Полный MVP (шаги, проверки, итог, напоминания, история, экспорт): ещё ~2 недели.


Пилот на 2 магазинах (shop_1, shop_2) + правки: ~1 неделя.
 Итого: ~2,5–3,5 недели до пилота.



9) Бюджет (ориентир)
Полный MVP на Google Таблицах: ~140–180 часов работы → 350–540 тыс. ₽ (по 2 500–3 000 ₽/час).


Упрощённый старт (без «возврата на доработку», без листа «Экспорт», только сводка в чат): ~90–110 часов → 225–330 тыс. ₽.
 На Таблицах чуть дешевле, чем с отдельной БД, т.к. не нужно админить базу.



10) Критерии готовности (что считаем «сделано»)
Сотрудник закрывает смену без Excel, все обязательные шаги пройдены, фото приложены.


В Таблице автоматически появляются записи по смене и шагам.


Менеджер получает сводку в чат и видит лист «Export» за период.


Напоминания приходят вовремя, ошибки ввода ловятся ботом.



11) Что нужно от вас для старта
Список трёх магазинов и менеджеров (кто получает сводки).


Ваш текущий чек-лист (фото/Excel) — мы переведём в шаблон.


Нормы/правила сверки (где допускается разница, где строго 0).


Порог недостачи для тревоги (например, > 300 ₽).


Доступ к Google: расшарить Таблицу на сервисный аккаунт (адрес пришлём).

